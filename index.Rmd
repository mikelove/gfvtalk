---
title       : GenomicFiles
subtitle    : 
author      : Michael Love
job         : 
framework   : html5slides   # {io2012, html5slides, shower, dzslides, ...}
highlighter : highlight.js  # {highlight.js, prettify, highlight}
hitheme     : tomorrow      # 
widgets     : [mathjax]     # {mathjax, quiz, bootstrap}
mode        : selfcontained # {standalone, draft}
knit        : slidify::knit2slides
---

<center>
# GenomicFiles [v1.0](http://www.bioconductor.org/packages/release/bioc/html/GenomicFiles.html)
</center>

<center>
Valerie Obenchain, Michael Love, Martin Morgan
</center>

<center>
BioC2014: 1 August 2014
</center>

---

# Example: epigenetic profiling of cell types

<br>

<center>
![](wustl.png)
</center>

---

# My solution in 2011

- BEDTools: reads in 200 bp windows for 100+ samples
- Load bin-level counts into R as a large sparse matrix

<br>

$$
\begin{array}{cccc}
. & . & 6 & 7 & . & 1 & . & . \\
. & 3 & . & . & . & . & . & . \\
. & . & . & . & . & . & 2 & . \\
. & . & . & . & . & . & . & . \\
3 & 9 & . & 5 & 2 & 8 & 1 & 6 \\
. & . & . & . & . & . & . & 1 \\
. & . & . & 5 & . & . & . & . \\
2 & . & . & . & . & . & . & . 
\end{array}
$$

---

# Limitations to this approach

<br>

- Matrix multiplication $X^t X$ possible, but slow (2 hours)
- Limits on functions: only sparse => sparse
- Must threshold low counts to stay < 10^9

<br>

`cannot allocate vector of length ...`

---

# Views approach

Each range is said to represent a *view* onto the sequence.

```{r,echo=FALSE}
library(IRanges)
```

```{r}
(x <- Rle(c(rep(0,5),1:5)))
(v <- Views(x, IRanges(4,7)))
```

---

# Operating on views

```{r}
v[[1]] * 10
viewApply(v, function(z) z * 10)
```

---

# Going back to epigenetic tracks

Want to load only one region at a time, no limit on # of files

<br>

<center>
![](diagram.png)
</center>

---

# Request to bioc-devel

<br><br>

Nov 2013 ML: "BigWigViews would be incredibly useful for genomics applications
where we want to scan along the genome looking at lots of samples."

Dec 2013 VO: "I've started a package called GenomicFileViews ...
to provide infrastructure for parallel execution over a group of common file types"

---

# My to do

- Profiling
- Guide user wrt optimization of region size
